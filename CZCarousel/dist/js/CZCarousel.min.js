/**
 * Created by caizhi on 16/3/24.
 */
function CZCarousel(a){this.options=$.extend({autoScrolling:true,fitToSectionDelay:3000,elementId:"",mouseOverPause:false,index:0,timeId:undefined,meow:true,meowPosition:"center",moveAnimate:"default",carouselDiv:null,carouselImageUi:null,carouselImageLiList:null,carouselMeowUi:null,carouselMeowLiList:null,customMoveAnimate:function(b){},onLeave:function(b){},afterLoad:function(b){}},a);this.init()}CZCarousel.prototype={init:function(){this.options.carouselDiv=document.getElementById(this.options.elementId);this.options.carouselImageUi=this.options.carouselDiv.getElementsByTagName("ui")[0];this.options.carouselImageLiList=this.options.carouselImageUi.getElementsByTagName("li");if(this.options.meow){this.addMeow()}this.resetElements();if(this.options.autoScrolling){this.start();if(this.options.mouseOverPause){this.options.carouselDiv.addEventListener("mouseover",this.pause(),false);this.options.carouselDiv.addEventListener("mouseout",this.restart(),false)}}},start:function(){this.options.timeId=window.setInterval(this.intervalFunction(),this.options.fitToSectionDelay)},pause:function(){var a=this;return function(){if(a.options.timeId!=undefined){clearInterval(a.options.timeId)}}},restart:function(){var a=this;return function(){a.options.timeId=window.setInterval(a.intervalFunction(),a.options.fitToSectionDelay)}},intervalFunction:function(){var a=this;return function(){a.nextPage()}},nextPage:function(){this.moveTo(this.options.index+1)()},moveTo:function(a){var b=this;return function(){var d=b.options.onLeave(b.options.index==-1?(b.options.carouselImageLiList.length-1):b.options.index);if(d!=undefined&&d==false){return}b.options.index=a;var c=b.resetElements();c.moveWidth="-"+(a*c.imgWidth);c.index=a;b.moveAnimation(c);b.options.index=b.options.index==(b.options.carouselImageLiList.length-1)?-1:b.options.index;b.options.afterLoad(b.options.index==-1?(b.options.carouselImageLiList.length-1):b.options.index)}},changeMeow:function(){for(var a=0;a<this.options.carouselMeowLiList.length;a++){if(a==this.options.index){addClass(this.options.carouselMeowLiList[a],"active")}else{removeClass(this.options.carouselMeowLiList[a],"active")}}},resetElements:function(){var b=this.options.carouselDiv.parentNode;var f=b.offsetWidth;this.options.carouselDiv.style.width=f+"px";for(var d=0;d<this.options.carouselImageLiList.length;d++){this.options.carouselImageLiList[d].style.width=f+"px"}this.options.carouselImageUi.style.width=(f*this.options.carouselImageLiList.length)+"px";var a=this.options.carouselImageLiList[this.options.index];var c=a.getElementsByTagName("img")[0];var e=c.offsetWidth;var g=this.options.carouselImageLiList.length*f;return{el:this.options.carouselImageUi,uiWidth:g,moveWidth:"-"+(this.options.index*e),imgWidth:e,index:this.options.index,totalNum:this.options.carouselImageLiList.length}},moveAnimation:function(a){if(this.options.moveAnimate=="default"){a.el.setAttribute("style","width: "+a.uiWidth+"px;transform:translateX("+a.moveWidth+"px"+");transition: transform .5s ease-in;")}else{if(this.options.moveAnimate=="custom"){this.options.customMoveAnimate(a)}}this.options.carouselDiv=a.el;this.changeMeow()},addMeow:function(){var c=document.createElement("ui");if(this.options.meowPosition=="center"){c.setAttribute("class","cz-carousel-meow center-side")}else{if(this.options.meowPosition=="left"){c.setAttribute("class","cz-carousel-meow left-side")}else{if(this.options.meowPosition=="right"){c.setAttribute("class","cz-carousel-meow right-side")}}}for(var b=0;b<this.options.carouselImageLiList.length;b++){var a=document.createElement("li");if(b==0){a.setAttribute("class","active")}c.appendChild(a);a.addEventListener("click",this.moveTo(b),false)}this.options.carouselDiv.appendChild(c);this.options.carouselMeowUi=this.options.carouselDiv.getElementsByTagName("ui")[1];this.options.carouselMeowLiList=this.options.carouselMeowUi.getElementsByTagName("li")}};function hasClass(b,a){return b.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))}function addClass(b,a){if(!this.hasClass(b,a)){b.className+=" "+a}}function removeClass(c,a){if(hasClass(c,a)){var b=new RegExp("(\\s|^)"+a+"(\\s|$)");c.className=c.className.replace(b," ")}}function toggleClass(b,a){if(hasClass(b,a)){removeClass(b,a)}else{addClass(b,a)}};